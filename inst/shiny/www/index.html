<!DOCTYPE html>
<html>
  <head>
    <title>dlvis - Visualization of Deep Learning Techniques</title>
    <script src="shared/jquery.js" type="text/javascript"></script>
    <script src="shared/shiny.js" type="text/javascript"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="css/pure-min.css">
    <link rel="stylesheet" href="css/grids-responsive-min.css">

    <link rel="stylesheet" type="text/css" href="shared/shiny.css"/>
    <link rel="stylesheet" type="text/css" href="css/custom.css"/>
    <script>
      $(document).ready(function() {
        var containers = document.querySelectorAll(".layers");

        for (var c of containers) {
          var cont = c;
          var side = cont.getAttribute("data-side");
          var middle_layer = document.createElement("input");
          middle_layer.type = "number";
          middle_layer.name = side + "_layer1";
          middle_layer.value = 2;
          middle_layer.min = 2;
          middle_layer.max = 3;
          middle_layer.classList.add("small-input");
          middle_layer.classList.add("middle-layer");
          middle_layer.classList.add("layer");

          var add_button = document.createElement("input");
          add_button.type = "button";
          add_button.value = "+";
          add_button.classList.add("pure-button");
          add_button.classList.add("mini-button");
          add_button.classList.add("pure-button-primary");
          add_button.onclick = function() {
            Shiny.unbindAll();
            var side = this.parentNode.getAttribute("data-side");

            // Add one before
            var new_layer = document.createElement("input");
            new_layer.type = "number";
            new_layer.classList.add("small-input");
            new_layer.classList.add("layer");
            new_layer.value = 2;
            this.parentNode.insertBefore(new_layer, this.parentNode.querySelector(".middle-layer"));

            // Add one afterwards
            var new_layer2 = document.createElement("input");
            new_layer2.type = "number";
            new_layer2.classList.add("small-input");
            new_layer2.classList.add("layer");
            new_layer2.value = 2;
            this.parentNode.insertBefore(new_layer2, this.parentNode.querySelector(".middle-layer").nextSibling);

            // Renumerate all layers
            var layers = this.parentNode.querySelectorAll(".layer");
            for (var i = 0; i < layers.length; i++) {
              layers[i].name = side + "_layer" + (i + 1);
            }

            this.parentNode.querySelector(".layer-counter").value = 2 + 1*this.parentNode.querySelector(".layer-counter").value;
            Shiny.bindAll();
          };

          var remove_button = document.createElement("input");
          remove_button.type = "button";
          remove_button.value = "\u2212"; // minus symbol
          remove_button.classList.add("pure-button");
          remove_button.classList.add("mini-button");
          remove_button.classList.add("pure-button-primary");
          remove_button.classList.add("pure-button-remove");
          remove_button.onclick = function() {
            if (this.parentNode.querySelector(".middle-layer").previousSibling) {
              Shiny.unbindAll();
              this.parentNode.removeChild(this.parentNode.querySelector(".middle-layer").previousSibling);
              this.parentNode.removeChild(this.parentNode.querySelector(".middle-layer").nextSibling);

              // Renumerate all layers
              var layers = this.parentNode.querySelectorAll(".layer");
              for (var i = 0; i < layers.length; i++) {
                layers[i].name = this.parentNode.getAttribute("data-side") + "_layer" + (i + 1);
              }

              this.parentNode.querySelector(".layer-counter").value -= 2;
              Shiny.bindAll();
            }
          }

          var layer_counter = document.createElement("input");
          layer_counter.type = "number";
          layer_counter.style.display = "none";
          layer_counter.classList.add("layer-counter");
          layer_counter.name = side + "_layer_count";
          layer_counter.value = 1;

          cont.appendChild(middle_layer);
          cont.appendChild(add_button);
          cont.appendChild(remove_button);
          cont.appendChild(layer_counter);
        }
      });
    </script>
  </head>
  <body>
    <div class="pure-g">
      <div class="pure-u-1-24 pure-u-md-1-6"></div>
      <div class="pure-u-22-24 pure-u-md-2-3">
        <div class="pure-g">
          <!-- Content START! -->
          <div class="pure-u-1-1">
            <header>
              <h1>dlvis</h1>
              <nav>
                <a href="https://github.com/fdavidcl/dlvis/blob/master/README.md">About</a>
                <a href="https://github.com/fdavidcl/dlvis/wiki">Documentation</a>
                <a href="https://github.com/fdavidcl/dlvis">Source code</a>
                <!--<a href="#">CRAN</a>-->
              </nav>
            </header>
          </div>
          <div class="pure-u-1-1">
            <form class="pure-form">
              <p>
                <span id="dataset_name" class="dataset-name shiny-text-output"></span>
                <label for="class_pos">Class attribute</label>
                <select id="class_pos" name="class_pos"></select>
                <label for="filename" class="pure-button pure-button-primary">Upload new dataset</label>
                <input type="file" name="filename" id="filename" hidden />
              </p>
            </form>
          </div>
          <div class="pure-u-1 pure-u-md-1-2">
            <div id="left_plot" class="shiny-plot-output plot"></div>
            <form class="plot-settings pure-form pure-form-aligned">
              <div class="pure-control-group">
                <label for="type">Type</label>
                <select id="left_type" name="left_type"></select>
              </div>
              <div class="pure-control-group">
                <label for="type">Activation function</label>
                <select id="left_activation" name="left_activation"></select>
              </div>
              <div class="pure-control-group">
                <label for="type">Number of epochs</label>
                <input type="number" id="left_epochs" name="left_epochs" class="medium-input" value=1 min=1></select>
              </div>
              <div class="pure-control-group">
                <label>Layers</label>
                <span class="numeric-input shiny-text-output" id="left_first_layer"></span>
                <span class="layers" data-side="left"></span>
                <span class="numeric-input shiny-text-output" id="left_last_layer"></span>
              </div>
            </form>
          </div>
          <div class="pure-u-1 pure-u-md-1-2">
            <div id="right_plot" class="shiny-plot-output plot"></div>
            <form class="plot-settings pure-form pure-form-aligned">
              <div class="pure-control-group">
                <label for="type">Type</label>
                <select id="right_type" name="right_type"></select>
              </div>
              <div class="pure-control-group">
                <label for="type">Activation function</label>
                <select id="right_activation" name="right_activation"></select>
              </div>
              <div class="pure-control-group">
                <label for="type">Number of epochs</label>
                <input type="number" id="right_epochs" name="right_epochs" class="medium-input" value=1 min=1></select>
              </div>
              <div class="pure-control-group">
                <label>Layers</label>
                <span class="numeric-input shiny-text-output" id="right_first_layer"></span>
                <span class="layers" data-side="right"></span>
                <span class="numeric-input shiny-text-output" id="right_last_layer"></span>
              </div>
            </form>
          </div>
          <div class="pure-u-1">
            <footer>
              dlvis &copy; David Charte. All code is licensed under the <a href="http://fdavidcl.mit-license.org/">MIT License</a> unless otherwise stated.
            </footer>
          </div>
          <!-- Content END! -->
        </div>
      </div>
      <div class="pure-u-1-24 pure-u-md-1-6"></div>
    </div>
  </body>
</html>
